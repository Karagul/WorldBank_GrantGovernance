{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Is the World Bank Financing Bad Governance in Developing Countries?\"\nauthor: \"Raulin L. Cadet\"\ndate: \"4 octobre 2019\"\noutput:\n  html_document: default\n  pdf_document: default\n---\n\n\n```{r setup, include=FALSE}\n#knitr::opts_chunk$set(echo = TRUE)\nlibrary(xlsx)\nlibrary(tidyverse)\nlibrary(ggplot2)\n\n```\n\nIn developing countries with high level of corruption, governance become worst when they receive grants from the World Bank. \n\n\n```{r data_import}\n# The data are imported bellow. The first one have data about grants fom the World. The second have the index of control for corruption. Higher index of control for corruption is a better performance.\ngrants<-read.csv(\"https://finances.worldbank.org/api/views/34vv-5t6y/rows.csv?accessType=DOWNLOAD&bom=true&format=true\")\n\nsheetName=\"GovernmentEffectiveness\"\ncorrup<-read.xlsx(\"wgidataset.xlsx\",sheetName =\"GovernmentEffectiveness\" ) #\"ControlofCorruption\" Source: https://info.worldbank.org/governance/wgi/Home/downLoadFile?fileName=wgidataset.xlsx\n\n```\n\n\n```{r grants_Clean}\ngrant<-data.frame(grants$Country,grants$Region,grants$Original.Principal.Amount,grants$Agreement.Signing.Date)\ncolnames(grant)<-c(\"Country\",\"Region\",\"Amount\",\"SignedDate\")\n\n# Function to convert date to Year only\ndateY<-function(x,formatDate){      \n  d=as.Date(x,format = formatDate)\n  new_d=as.numeric(format(d,\"%Y\"))\n  return(new_d)\n}\n\n# Creating a column for the year of signed agreements between the World Bank and the beneficiaries of grants.\ngrant['Year']=dateY(grant$SignedDate,format=\"%m/%d/%Y\")\n\nstr(grant)            # shows that the variable Amount is a factor. It should be numeric.\ngrant$Amount=as.numeric(grant$Amount) # converting the variable \"Amount\" as numeric\n```\n\n\n```{r grants_Clean2}\n# Calculate total of grant, by country, by year\ngrant2<-grant%>%\n  group_by(Country,Region,Year)%>%\n    summarize(Total=sum(Amount))\n\nhead(grant2,4)                    # Viewing the first four rows of the data frame 'grant2'\n```\n\n\n```{r corrup_Clean}\n# The variable is control of corruption. Then high value is better\ncolnames(corrup)<-t(corrup[12,]) # Add names of columns, available in line 12.\ncorrup2<-corrup[13:226,]         # Selecting data starting on row 12. The rows above 12 do not contain data, but title information.\n\n# Selecting only the estimate's columns and the country name column. They provide the index data. The other columns are other statistics about the index.\ncorrup3=data.frame(corrup2$`Country/Territory`)\nfor(i in 1:dim(corrup2)[2]){\n  if(colnames(corrup2[i])==\"Estimate\"){\n    corrup3[as.character(i)]=corrup2[,i]\n  }\n  \n}\n\n# Names the columns of the new data frame with the years\nYear<-unique(c(t(corrup[11,])))[-1]\nYear\ncolnames(corrup3)<-c(\"Country\",Year)\n\n# Selecting data from year 2002\nyear<-seq(2002,2015,1)\ncorrup3<-corrup3[,c(\"Country\",year)]\n\n######## Select in corrup only countries that receive grants #####\ncorrupT<-t(corrup3)                 # Transpose the dataframe to have the countries name in columns\ncolnames(corrupT)<-t(corrupT[1,])   # Change default name to countries name which are in row 1.\ncorrupT<-corrupT[-1,]               # Remove the first row that contains the countries names\n\nunq<-function(x){                   # Function that returning a vector of unique values separated by comma\n  y=NULL\n  for(i in 1:length(x)){\n    if(!x[i] %in% y){\n      y=c(y,x[i])\n    }\n  }\n  return(y)\n}\n\n\ngrant_countries<-unique(as.character(grant2$Country)) # Names of countries that receive grants from 2002 to 2015\n\n\n###########################################################################################\n######## Correct difference in countries names spelling, between the dataframe ############\ncog=NULL\nfor(i in 1:length(grant_countries)){ # Identify difference in countries names in the two data frame\nif(!grant_countries[i] %in% colnames(corrupT)){\n    cog=c(cog,grant_countries[i])\n  }\n}\n\n# Data frame that contains names spelling that are differents\nCoSpell<-data.frame(corName=c(\"Central African Republic\", \"Congo, Dem. Rep.\",\"Congo, Rep.\",\"Lao PDR\",\"Micronesia, Fed. Sts.\",\"SÃ£o TomÃ© and Principe\",\"Yemen, Rep.\",\"CÃ´te d'Ivoire\"),\n        grantName=c(\"Central Africa\",\"Congo, Democratic Republic of\", \"Congo, Republic of\",\"Lao People's Democratic Republic\",\"Micronesia, Federated States of\",\"Sao Tome and Principe\",\"Yemen, Republic of\",\"Cote d'Ivoire\"))\n\n\nfor(i in 1:dim(CoSpell)[1]){ # Correct the names in the data frame of control for corruption\n  cf=gsub(CoSpell$corName[i],CoSpell$grantName[i],colnames(corrupT))\n}\n\ncolnames(corrupT)<-cf       # add corrected names as column names of the data frame of control for corruption\n\n##########################################################################################\n# Identify countries names that appear in both data frame\nco=NULL\nfor(i in 1:length(grant_countries)){ \nif(grant_countries[i] %in% colnames(corrupT)){\n    co=c(co,grant_countries[i])\n  }\n}\n\ncorrupFi<-corrupT[,co];dim(corrupFi)      # This data frame (corrupFi) has 62 countries found in grant2 \n\ncorrupFinal<-data.frame(newcol = c(t(corrupFi)), stringsAsFactors=FALSE) # Create a data frame of one column, with data of control of corruption for all countries that receive grants from the WB.\n\n\n####### continue below\n\n\n\n\n\n\ncorrupFinal[\"Year\"]<-rep(year,dim(corrupFinal)[2])   # Adding the column of the year to the new data frame.\n\n\nrep2<-function(x,n){    # This function should repeat each element of a vector n times \n  y=NULL\n  for(i in 1:length(x)){\n    y=c(y,rep(x[i],n))\n  }\n  return(y)\n}\n\n\ncorrupFinal[\"Country\"]<-rep2(co,length(year));dim(corrupFinal) # Data frame with index of control for corruption, for countries that receive grant from the World Bank.\n\n# Data frame of grants with only country found in the data frame 'corrupFinal'. However, data are not available for some years, for some countries. That's why they do not have the same number of rows.            \nGrant<-grant2 %>%            \n  filter(Country %in% co)\ndim(Grant)\n```\n\n\n\n```{r Merge}\n# Merging data frame 'Grant' and 'corrupFinal' where country name and year are the same\nDatFinal<-inner_join(Grant, corrupFinal, by = NULL, copy = FALSE, suffix = c(\".grant\", \".corrup\") )\ncolnames(DatFinal)<-c(colnames(DatFinal)[1:3],\"Grant\",\"Control\")\n```\n\n```{r DatExplor}\nstr(DatFinal)\n\nDatFinal <- within(DatFinal, {        # Changing type of some variable in 'DatFinal'   \n    Country <- factor(Country)        # Convert 'Country' to factor\n    Control<-as.numeric(Control)      # Convert 'Control' to numeric\n    })\n\n```\n\n\nA scatter plot of the linkage between grants and government effecctiveness is presented below. It shows that the World Bank tends not to account for how the population perceive their governments effectiveness to grant funds to their countries.\n\n```{r graphglobal,warning=FALSE,message=FALSE}\n#cor(DatFinal$Grant,DatFinal$Control)\ngg1 <- ggplot(DatFinal, aes(x=Control, y=Grant)) + \n  geom_point(col='forestgreen',size=2,shape=1) + \n  geom_smooth( se=F,col='blue') + \n  #facet_wrap(~Region) +\n  #xlim(c(0, 0.1)) + \n  #ylim(c(0, 500000)) + \n  labs(#subtitle=\"Area Vs Population\", \n       y=\"Grant\", \n       x=\"Government Effectiveness\", \n      # title=\"Linkage between Grant from the World Bank and Governement Effectiveness\", \n       caption = \"Source: Graphic by Raulin L. Cadet, with data from the World Bank\")+\n  theme_classic()\n\nplot(gg1)\n\n```\n\nConsidering a scotter plot, for the same variables, but by region, only the graphic related to Africa reveals that grants tend to increase with high perception of government effectiveness. However, this relation seems to bo weak. Considering East Asia and Pacific, the curve estimating the raltion between grants and government effectiveness is almost flat, showing no relation between them. For the other regions, the relation is not consistent, suggesting that the World Bank is not following a rule related to government effectiveness to grant fund.\n\nThe absence of such a rule sould not encourage government of developing countries to improve the effectiveness of public policy.\n\n```{r graphRegion,warning=FALSE,message=FALSE}\ngg2 <- ggplot(DatFinal, aes(x=Control, y=Grant)) + \n  geom_point(col='forestgreen',size=2,shape=1) + \n  geom_smooth( se=F,col='blue') + \n  facet_wrap(~Region) +\n  #xlim(c(0, 0.1)) + \n  #ylim(c(0, 500000)) + \n  labs(subtitle=\"By Region (2002-2015)\", \n       y=\"Grant\", \n       x=\"Government Effectiveness\", \n       title=\"Linkage between Grant from the World Bank and Governement Effectiveness\", \n       caption = \"Source: Graphic by Raulin L. Cadet, with data from the World Bank\")+\n  theme_classic()\n\nplot(gg2)\n\n```\n\n",
    "created" : 1570195103028.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3853474924",
    "id" : "80DDBAA6",
    "lastKnownWriteTime" : 1570450045,
    "last_content_update" : 1570450045,
    "path" : "C:/Users/CRL/Box Sync/GithubCRL/WorldBank_GrantGovernance/WB_grants.Rmd",
    "project_path" : "WB_grants.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}